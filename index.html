<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Tic Tac Toe</title>
  <link type="text/css" rel="stylesheet" href="style.css">
  <script src="main.js"></script>
</head>

<body>
  <h2 id='title'>Tic Tac Toe</h2>
  <button id="button" onclick="startNewGame()">Start New Game</button>
  <div class="board" style="font-size: 130px">
    <div id="row-1">
      <div id="cell-0" class="cell r1 c1"></div>
      <div id="cell-1" class="cell r1 c2"></div>
      <div id="cell-2" class="cell r1 c3"></div>
    </div>
    <div id="row-2">
      <div id="cell-3" class="cell r2 c1"></div>
      <div id="cell-4" class="cell r2 c2"></div>
      <div id="cell-5" class="cell r2 c3"></div>
    </div>
    <div id="row-3">
      <div id="cell-6" class="cell r3 c1"></div>
      <div id="cell-7" class="cell r3 c2"></div>
      <div id="cell-8" class="cell r3 c3"></div>
    </div>
  </div>
  <script>

class Player { 
  constructor (letter){
    this.letter = letter;
  }
  switchPlayer(){
    if(this.letter === "X"){
      this.letter = "O";
    } else {
      this.letter = "X";
    }
  }
}

let currentPlayer;
let continuePlay = true;
setupCells();
startNewGame();

function startNewGame(){
  console.log("New Game, Player X starts")
  currentPlayer = new Player ("X");
  count = 0;
  continuePlay = true;
  clearBoard();
};

function clearBoard(){
  let cells = document.getElementsByClassName("cell");
  for (let cell of cells){
    cell.innerHTML = ""
  }
  document.getElementById('title').innerHTML= "New Game of Tic Tac Toe!";
};

// determines which cell was clicked and calls addXO
function setupCells(){
  let cells = document.getElementsByClassName("cell");
  for (let cell of cells){
    console.log({cell});
    cell.onclick = function() { addXO(cell)};
  }
};

// adds X or O to board depending on Player 1 or 2
function addXO(cell){
  if(cell.innerHTML === "" && continuePlay === true){
    cell.innerHTML = currentPlayer.letter;
    if (checkWinOrTie(currentPlayer.letter) === false){
      currentPlayer.switchPlayer();
    } 
  }
};

function fullBoard(){
  let cells = document.getElementsByClassName("cell");
  for (let cell of cells){
    if (cell.innerHTML === "X" || cell.innerHTML === "O"){
      count += 1;
    }
    console.log(count)
    if(count === 9){
        return true;
      } else {
        return false;
      }
  }
};

function checkWinOrTie(player){
  
  if(winCondition(player) === true){
    console.log("win")
    document.getElementById('title').innerHTML= "Player " + player + " Wins!!!";
    continuePlay = false;
    return true;
  } 
  if (fullBoard()){
    console.log("tie game");
    document.getElementById('title').innerHTML= "Tie Game!";
    continuePlay = false;
    return true;
  } 
  return false;
}
// needs to be refactored but works for every win condition!
function winCondition(letter){
  // row win condition:
  for (let number = 1; number < 4; number++){
    let rows = document.getElementsByClassName("r" + number);
    let rowArray = [];
    for (let row of rows) {
      rowArray.push(row.innerHTML);
    }
    if (rowArray.join("") === "XXX" || rowArray.join("") === "OOO"){
      return true;
    }
  }
  
  // column win condition
  for (let number = 1; number < 4; number++){
    let columns = document.getElementsByClassName("c" + number);
    let columnArray = [];
    for (let column of columns) {
      columnArray.push(column.innerHTML);
    }
    if (columnArray.join("") === "XXX" || columnArray.join("") === "OOO"){
      return true;
    }
  }
  
  if (document.getElementById('cell-0').innerHTML === letter && document.getElementById('cell-4').innerHTML === letter && document.getElementById('cell-8').innerHTML === letter){
    return true;
  }
  if (document.getElementById('cell-2').innerHTML === letter && document.getElementById('cell-4').innerHTML === letter && document.getElementById('cell-6').innerHTML === letter){
    return true;
  } 
  return false;
};



</script>
</body>

</html>